---
layout: post
cid: 13
title: js正则一些坑
slug: js-reg
date: 2017/07/20 13:12:00
updated: 2017/12/08 23:15:29
status: publish
author: alex
categories: 
  - 默认分类
  - 技术
tags: 
  - javascript
  - 正则表达式
---


使用正则表达式字面量和使用 RegExp 构造函数创建的正则表达式不一样。在 ECMAScript 3 中, 正则表达式字面量始终会共享同一个RegExp实例,而使用构造函数创建的每一个新RegExp实例都是一个新实例。来看下面的例子。

```
var re = null,
  i;
for (i=0; i < 10; i++){
  re = /cat/g;
  console.log( re.test("catastrophe"));
}
for (i=0; i < 10; i++){
  re = new RegExp("cat", "g");
   console.log( re.test("catastrophe"));

}
```

在第一个循环中,即使是循环体中指定的,但实际上只为 /cat/ 创建了一个 RegExp 实例。由于实例属性不会重置,所以在循环中再次调用 test() 方法会失败。这是因为第一次调用 test() 找到了"cat",但第二次调用是从索引为 3 的字符(上一次匹配的末尾)开始的,所以就找不到它了。由于会测试到字符串末尾,所以下一次再调用 test()就又从开头开始了。
第二个循环使用 RegExp 构造函数在每次循环中创建正则表达式。因为每次迭代都会创建一个新的 RegExp 实例,所以每次调用 test()都会返回 true。

- 如果采用正则对象方式，RegExg接收的是字符串，\反斜杠是转义字符，\d会变成d，此时需要使用两个反斜杠，即\\d来达到\d效果；但是在字面量方式中，不是字符串，所以使用一个反斜杠即可。
- 正则对象方式，可以接收参数，而正则字面量方式不可以。